{"ast":null,"code":"import _objectSpread from\"/Users/liamkrass/Documents/satProjectV2/sat-practice-app-1/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef,useCallback}from'react';import{typography,applyTypography,textColors}from'../styles/typography';import{formatMoney,roundMoney,multiplyMoney,parseMoneyInput,sanitizeMoney,isValidMoney}from'../utils/money';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CrashGame=_ref=>{let{onClose,balance,onEarn}=_ref;const[gameState,setGameState]=useState({betAmount:roundMoney(1),gameStatus:'waiting',currentMultiplier:1.0,crashPoint:0,cashedOut:false,cashOutAt:null,gameHistory:[2.14,1.06,3.87,1.42,8.91,1.13,2.67,1.89,4.33,1.24]});const[betInput,setBetInput]=useState('1.00');const[autoCashOutInput,setAutoCashOutInput]=useState('');const intervalRef=useRef(null);const gameStartTimeRef=useRef(0);// Generate crash point using provably fair algorithm (simplified)\nconst generateCrashPoint=useCallback(()=>{const random=Math.random();// Using crash game formula: 99 / (100 - random * 99)\n// This gives a realistic distribution similar to Stake\nconst crashPoint=99/(100-random*99);return Math.max(1.0,Math.round(crashPoint*100)/100);},[]);const startNewGame=useCallback(()=>{if(balance<gameState.betAmount)return;const newCrashPoint=generateCrashPoint();setGameState(prev=>_objectSpread(_objectSpread({},prev),{},{gameStatus:'running',currentMultiplier:1.0,crashPoint:newCrashPoint,cashedOut:false,cashOutAt:null}));// Deduct bet amount\nonEarn(-roundMoney(gameState.betAmount));gameStartTimeRef.current=Date.now();// Start the multiplier animation\nintervalRef.current=setInterval(()=>{const elapsed=(Date.now()-gameStartTimeRef.current)/1000;// Multiplier grows exponentially over time\nconst multiplier=Math.pow(1.05,elapsed*10);setGameState(prev=>{if(prev.gameStatus!=='running')return prev;if(multiplier>=prev.crashPoint){// Game crashed\nif(intervalRef.current){clearInterval(intervalRef.current);intervalRef.current=null;}return _objectSpread(_objectSpread({},prev),{},{currentMultiplier:prev.crashPoint,gameStatus:'crashed',gameHistory:[prev.crashPoint,...prev.gameHistory.slice(0,9)]});}// Check auto cash out\nif(prev.cashOutAt&&multiplier>=prev.cashOutAt&&!prev.cashedOut){if(intervalRef.current){clearInterval(intervalRef.current);intervalRef.current=null;}const winAmount=multiplyMoney(gameState.betAmount,prev.cashOutAt);onEarn(roundMoney(winAmount));return _objectSpread(_objectSpread({},prev),{},{currentMultiplier:prev.cashOutAt,gameStatus:'won',cashedOut:true,gameHistory:[prev.cashOutAt,...prev.gameHistory.slice(0,9)]});}return _objectSpread(_objectSpread({},prev),{},{currentMultiplier:multiplier});});},50);},[balance,gameState.betAmount,generateCrashPoint,onEarn]);const cashOut=useCallback(()=>{if(gameState.gameStatus!=='running'||gameState.cashedOut)return;if(intervalRef.current){clearInterval(intervalRef.current);intervalRef.current=null;}const winAmount=multiplyMoney(gameState.betAmount,gameState.currentMultiplier);onEarn(roundMoney(winAmount));setGameState(prev=>_objectSpread(_objectSpread({},prev),{},{gameStatus:'won',cashedOut:true,gameHistory:[prev.currentMultiplier,...prev.gameHistory.slice(0,9)]}));},[gameState.gameStatus,gameState.cashedOut,gameState.betAmount,gameState.currentMultiplier,onEarn]);const updateBetAmount=useCallback(value=>{setBetInput(value);const amount=parseMoneyInput(value);if(isValidMoney(amount)){setGameState(prev=>_objectSpread(_objectSpread({},prev),{},{betAmount:sanitizeMoney(amount)}));}},[]);const updateAutoCashOut=useCallback(value=>{setAutoCashOutInput(value);if(value===''){setGameState(prev=>_objectSpread(_objectSpread({},prev),{},{cashOutAt:null}));}else{const multiplier=parseFloat(value);if(!isNaN(multiplier)&&multiplier>=1.01){setGameState(prev=>_objectSpread(_objectSpread({},prev),{},{cashOutAt:multiplier}));}}},[]);const resetGame=useCallback(()=>{if(intervalRef.current){clearInterval(intervalRef.current);intervalRef.current=null;}setGameState(prev=>_objectSpread(_objectSpread({},prev),{},{gameStatus:'waiting',currentMultiplier:1.0,crashPoint:0,cashedOut:false,cashOutAt:null}));},[]);useEffect(()=>{return()=>{if(intervalRef.current){clearInterval(intervalRef.current);}};},[]);const getMultiplierColor=()=>{if(gameState.gameStatus==='crashed')return'#ef4444';if(gameState.gameStatus==='won')return'#10b981';if(gameState.currentMultiplier>=2)return'#f59e0b';return'#5eead4';};const isGameActive=gameState.gameStatus==='running';const canBet=gameState.gameStatus==='waiting'&&balance>=gameState.betAmount;const canCashOut=gameState.gameStatus==='running'&&!gameState.cashedOut;return/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:0,left:0,right:0,bottom:0,background:'rgba(0, 0, 0, 0.8)',backdropFilter:'blur(8px)',display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center',padding:20,overflow:'auto',zIndex:1000},children:/*#__PURE__*/_jsxs(\"div\",{onClick:e=>e.stopPropagation(),style:{background:'linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%)',borderRadius:'20px',border:'2px solid #5eead4',boxShadow:'0 25px 50px rgba(0, 0, 0, 0.5)',width:'95vw',height:'95vh',maxWidth:'1400px',maxHeight:'900px',display:'flex',flexDirection:'column',overflow:'hidden',padding:'20px'},children:[/*#__PURE__*/_jsx(\"style\",{children:\"\\n        .crash-game {\\n          /* Remove old positioning styles */\\n        }\\n        \\n        .crash-header {\\n          display: flex;\\n          justify-content: space-between;\\n          align-items: center;\\n          margin-bottom: 24px;\\n        }\\n        \\n        .crash-close-btn {\\n          background: rgba(94, 234, 212, 0.1);\\n          border: 1px solid rgba(94, 234, 212, 0.3);\\n          border-radius: 10px;\\n          color: #5eead4;\\n          padding: 8px 16px;\\n          cursor: pointer;\\n          font-size: 1.5rem;\\n          font-weight: bold;\\n          transition: all 0.2s ease;\\n          display: flex;\\n          align-items: center;\\n          gap: 8px;\\n        }\\n        \\n        .crash-close-btn:hover {\\n          background: rgba(94, 234, 212, 0.2);\\n          transform: translateY(-1px);\\n        }\\n        \\n        .crash-graph {\\n          background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);\\n          border: 2px solid #5eead4;\\n          border-radius: 16px;\\n          padding: 32px;\\n          margin: 24px 0;\\n          position: relative;\\n          overflow: hidden;\\n          min-height: 400px;\\n          display: flex;\\n          align-items: center;\\n          justify-content: center;\\n        }\\n        \\n        .crash-visual-container {\\n          position: absolute;\\n          top: 0;\\n          left: 0;\\n          right: 0;\\n          bottom: 0;\\n          display: flex;\\n          align-items: center;\\n          justify-content: center;\\n          z-index: 1;\\n        }\\n        \\n        .crash-multiplier {\\n          font-size: 4rem;\\n          font-weight: bold;\\n          text-align: center;\\n          text-shadow: 0 0 20px currentColor;\\n          transition: all 0.1s ease;\\n          z-index: 10;\\n          position: relative;\\n        }\\n        \\n        .crash-status {\\n          position: absolute;\\n          top: 20px;\\n          left: 20px;\\n          padding: 8px 16px;\\n          border-radius: 8px;\\n          font-weight: bold;\\n          font-size: 0.875rem;\\n          text-transform: uppercase;\\n          letter-spacing: 0.05em;\\n          z-index: 10;\\n        }\\n        \\n        .crash-visual-line {\\n          position: absolute;\\n          bottom: 60px;\\n          left: 40px;\\n          right: 40px;\\n          height: 120px;\\n          overflow: hidden;\\n        }\\n        \\n        .crash-curve-svg {\\n          width: 100%;\\n          height: 100%;\\n          position: absolute;\\n          bottom: 0;\\n          left: 0;\\n        }\\n        \\n        .crash-curve-path {\\n          fill: none;\\n          stroke: url(#crashGradient);\\n          stroke-width: 4;\\n          filter: drop-shadow(0 0 8px rgba(251, 191, 36, 0.6));\\n        }\\n        \\n        .crash-visual-progress {\\n          height: 100%;\\n          background: transparent;\\n          border-radius: 2px;\\n          transition: width 0.1s ease;\\n          position: relative;\\n        }\\n        \\n        .crash-visual-rocket {\\n          position: absolute;\\n          right: -15px;\\n          top: 50%;\\n          transform: translateY(-50%);\\n          width: 40px;\\n          height: 40px;\\n          background: radial-gradient(circle, #fbbf24 0%, #f59e0b 70%);\\n          border-radius: 50%;\\n          display: flex;\\n          align-items: center;\\n          justify-content: center;\\n          font-size: 20px;\\n          animation: rocketFly 0.3s ease-in-out infinite alternate;\\n          box-shadow: 0 0 15px rgba(251, 191, 36, 0.6);\\n        }\\n        \\n        .crash-rocket-trail {\\n          position: absolute;\\n          right: 5px;\\n          top: 50%;\\n          transform: translateY(-50%);\\n          width: 30px;\\n          height: 3px;\\n          background: linear-gradient(90deg, transparent 0%, #fbbf24 50%, #f59e0b 100%);\\n          border-radius: 2px;\\n          animation: trail 0.2s ease-in-out infinite;\\n        }\\n        \\n        @keyframes rocketFly {\\n          0% { \\n            transform: translateY(-50%) scale(1) rotate(-5deg);\\n            box-shadow: 0 0 10px rgba(251, 191, 36, 0.4);\\n          }\\n          100% { \\n            transform: translateY(-50%) scale(1.15) rotate(5deg);\\n            box-shadow: 0 0 20px rgba(251, 191, 36, 0.8);\\n          }\\n        }\\n        \\n        @keyframes trail {\\n          0% { opacity: 0.6; width: 20px; }\\n          100% { opacity: 1; width: 35px; }\\n        }\\n        \\n        @keyframes rocketPulse {\\n          0% { transform: translateY(-50%) scale(1); }\\n          100% { transform: translateY(-50%) scale(1.1); }\\n        }\\n        \\n        .crash-explosion {\\n          position: absolute;\\n          right: -30px;\\n          top: 50%;\\n          transform: translateY(-50%);\\n          width: 80px;\\n          height: 80px;\\n          background: radial-gradient(circle, #fbbf24 0%, #ef4444 30%, #dc2626 60%, transparent 80%);\\n          border-radius: 50%;\\n          animation: explosion 0.6s ease-out infinite;\\n          font-size: 24px;\\n          display: flex;\\n          align-items: center;\\n          justify-content: center;\\n        }\\n        \\n        @keyframes explosion {\\n          0% { \\n            transform: translateY(-50%) scale(0.5);\\n            opacity: 1;\\n            box-shadow: 0 0 20px rgba(239, 68, 68, 0.8);\\n          }\\n          50% {\\n            transform: translateY(-50%) scale(1.2);\\n            opacity: 0.8;\\n            box-shadow: 0 0 40px rgba(239, 68, 68, 0.6);\\n          }\\n          100% { \\n            transform: translateY(-50%) scale(2);\\n            opacity: 0;\\n            box-shadow: 0 0 60px rgba(239, 68, 68, 0.2);\\n          }\\n        }\\n        \\n        .status-waiting {\\n          background: #374151;\\n          color: #9ca3af;\\n        }\\n        \\n        .status-running {\\n          background: #065f46;\\n          color: #10b981;\\n          animation: pulse 2s infinite;\\n        }\\n        \\n        .status-crashed {\\n          background: #7f1d1d;\\n          color: #ef4444;\\n        }\\n        \\n        .status-won {\\n          background: #064e3b;\\n          color: #10b981;\\n        }\\n        \\n        @keyframes pulse {\\n          0%, 100% { opacity: 1; }\\n          50% { opacity: 0.7; }\\n        }\\n        \\n        .crash-history {\\n          display: flex;\\n          gap: 8px;\\n          margin: 16px 0;\\n          overflow-x: auto;\\n          padding: 8px;\\n        }\\n        \\n        .history-item {\\n          padding: 8px 12px;\\n          border-radius: 8px;\\n          font-weight: bold;\\n          font-size: 0.875rem;\\n          min-width: 60px;\\n          text-align: center;\\n          white-space: nowrap;\\n        }\\n        \\n        .history-green {\\n          background: #065f46;\\n          color: #10b981;\\n        }\\n        \\n        .history-red {\\n          background: #7f1d1d;\\n          color: #ef4444;\\n        }\\n        \\n        .controls-grid {\\n          display: grid;\\n          grid-template-columns: 1fr 1fr;\\n          gap: 16px;\\n          margin-top: 24px;\\n        }\\n        \\n        .control-group {\\n          background: #1e293b;\\n          border: 1px solid #374151;\\n          border-radius: 12px;\\n          padding: 16px;\\n        }\\n        \\n        .control-label {\\n          font-size: 0.875rem;\\n          font-weight: 600;\\n          color: #9ca3af;\\n          margin-bottom: 8px;\\n          text-transform: uppercase;\\n          letter-spacing: 0.05em;\\n        }\\n        \\n        .control-input {\\n          width: 100%;\\n          padding: 12px;\\n          border: 1px solid #4b5563;\\n          border-radius: 8px;\\n          background: #374151;\\n          color: white;\\n          font-size: 1rem;\\n          font-weight: 600;\\n        }\\n        \\n        .control-input:focus {\\n          outline: none;\\n          border-color: #5eead4;\\n          box-shadow: 0 0 0 3px rgba(94, 234, 212, 0.1);\\n        }\\n        \\n        .action-buttons {\\n          display: grid;\\n          grid-template-columns: 1fr 1fr;\\n          gap: 16px;\\n          margin-top: 24px;\\n        }\\n        \\n        .btn-primary {\\n          padding: 16px 24px;\\n          border: none;\\n          border-radius: 12px;\\n          font-size: 1rem;\\n          font-weight: bold;\\n          cursor: pointer;\\n          transition: all 0.2s ease;\\n          text-transform: uppercase;\\n          letter-spacing: 0.05em;\\n        }\\n        \\n        .btn-bet {\\n          background: linear-gradient(135deg, #059669 0%, #047857 100%);\\n          color: white;\\n        }\\n        \\n        .btn-bet:hover:not(:disabled) {\\n          background: linear-gradient(135deg, #047857 0%, #065f46 100%);\\n          transform: translateY(-2px);\\n          box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);\\n        }\\n        \\n        .btn-bet:disabled {\\n          background: #374151;\\n          color: #6b7280;\\n          cursor: not-allowed;\\n        }\\n        \\n        .btn-cashout {\\n          background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);\\n          color: white;\\n        }\\n        \\n        .btn-cashout:hover:not(:disabled) {\\n          background: linear-gradient(135deg, #d97706 0%, #b45309 100%);\\n          transform: translateY(-2px);\\n          box-shadow: 0 4px 12px rgba(245, 158, 11, 0.4);\\n        }\\n        \\n        .btn-cashout:disabled {\\n          background: #374151;\\n          color: #6b7280;\\n          cursor: not-allowed;\\n        }\\n      \"}),/*#__PURE__*/_jsxs(\"div\",{className:\"crash-header\",children:[/*#__PURE__*/_jsxs(\"h1\",{style:_objectSpread(_objectSpread({},applyTypography(typography.heading.lg)),{},{color:textColors.primary,display:'flex',alignItems:'center',gap:'12px'}),children:[/*#__PURE__*/_jsxs(\"svg\",{width:\"32\",height:\"32\",viewBox:\"0 0 24 24\",fill:\"none\",xmlns:\"http://www.w3.org/2000/svg\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M12 2L13 8L19 9L13 10L12 16L11 10L5 9L11 8L12 2Z\",fill:\"#fbbf24\"}),/*#__PURE__*/_jsx(\"circle\",{cx:\"12\",cy:\"20\",r:\"2\",fill:\"#ef4444\"})]}),\"Crash\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:onClose,className:\"crash-close-btn\",children:[/*#__PURE__*/_jsx(\"svg\",{width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",xmlns:\"http://www.w3.org/2000/svg\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M19 12H5M12 19L5 12L12 5\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\"})}),\"Back\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"crash-graph\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"crash-visual-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"crash-visual-line\",children:/*#__PURE__*/_jsxs(\"svg\",{className:\"crash-curve-svg\",viewBox:\"0 0 400 120\",children:[/*#__PURE__*/_jsx(\"defs\",{children:/*#__PURE__*/_jsxs(\"linearGradient\",{id:\"crashGradient\",x1:\"0%\",y1:\"0%\",x2:\"100%\",y2:\"0%\",children:[/*#__PURE__*/_jsx(\"stop\",{offset:\"0%\",stopColor:\"#10b981\"}),/*#__PURE__*/_jsx(\"stop\",{offset:\"50%\",stopColor:\"#f59e0b\"}),/*#__PURE__*/_jsx(\"stop\",{offset:\"100%\",stopColor:\"#ef4444\"})]})}),/*#__PURE__*/_jsx(\"path\",{className:\"crash-curve-path\",d:\"M 0 120 Q \".concat(Math.min(400,(gameState.currentMultiplier-1)*40),\" \").concat(Math.max(20,120-(gameState.currentMultiplier-1)*15),\" \").concat(Math.min(400,(gameState.currentMultiplier-1)*40),\" \").concat(Math.max(20,120-(gameState.currentMultiplier-1)*15)),strokeDasharray:\"\".concat(Math.min(400,(gameState.currentMultiplier-1)*40),\" 400\"),strokeDashoffset:400-Math.min(400,(gameState.currentMultiplier-1)*40)}),gameState.gameStatus==='running'&&!gameState.cashedOut&&/*#__PURE__*/_jsxs(\"g\",{children:[/*#__PURE__*/_jsx(\"circle\",{cx:Math.min(390,(gameState.currentMultiplier-1)*40),cy:Math.max(30,120-(gameState.currentMultiplier-1)*15),r:\"8\",fill:\"#fbbf24\",filter:\"drop-shadow(0 0 8px rgba(251, 191, 36, 0.8))\",children:/*#__PURE__*/_jsx(\"animate\",{attributeName:\"r\",values:\"6;10;6\",dur:\"0.5s\",repeatCount:\"indefinite\"})}),/*#__PURE__*/_jsx(\"text\",{x:Math.min(390,(gameState.currentMultiplier-1)*40),y:Math.max(25,115-(gameState.currentMultiplier-1)*15),textAnchor:\"middle\",fontSize:\"12\",fill:\"#fbbf24\",children:\"\\uD83D\\uDE80\"})]}),gameState.gameStatus==='crashed'&&/*#__PURE__*/_jsxs(\"g\",{children:[/*#__PURE__*/_jsx(\"circle\",{cx:Math.min(390,(gameState.currentMultiplier-1)*40),cy:Math.max(30,120-(gameState.currentMultiplier-1)*15),r:\"15\",fill:\"#ef4444\",opacity:\"0.8\",children:/*#__PURE__*/_jsx(\"animate\",{attributeName:\"r\",values:\"8;20;8\",dur:\"0.6s\",repeatCount:\"indefinite\"})}),/*#__PURE__*/_jsx(\"text\",{x:Math.min(390,(gameState.currentMultiplier-1)*40),y:Math.max(35,125-(gameState.currentMultiplier-1)*15),textAnchor:\"middle\",fontSize:\"16\",fill:\"#fff\",children:\"\\uD83D\\uDCA5\"})]})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"crash-status \".concat(gameState.gameStatus==='waiting'?'status-waiting':gameState.gameStatus==='running'?'status-running':gameState.gameStatus==='crashed'?'status-crashed':'status-won'),children:[gameState.gameStatus==='waiting'&&'Waiting for next round',gameState.gameStatus==='running'&&'Flying...',gameState.gameStatus==='crashed'&&'Crashed!',gameState.gameStatus==='won'&&'Cashed Out!']}),/*#__PURE__*/_jsxs(\"div\",{className:\"crash-multiplier\",style:{color:getMultiplierColor()},children:[gameState.currentMultiplier.toFixed(2),\"x\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"crash-history\",children:gameState.gameHistory.map((multiplier,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"history-item \".concat(multiplier>=2?'history-green':'history-red'),children:[multiplier.toFixed(2),\"x\"]},index))}),/*#__PURE__*/_jsxs(\"div\",{className:\"controls-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"control-group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"control-label\",children:\"Bet Amount\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:betInput,onChange:e=>updateBetAmount(e.target.value),className:\"control-input\",disabled:isGameActive,placeholder:\"1.00\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"control-group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"control-label\",children:\"Auto Cash Out (Optional)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:autoCashOutInput,onChange:e=>updateAutoCashOut(e.target.value),className:\"control-input\",disabled:isGameActive,placeholder:\"2.00\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"action-buttons\",children:[gameState.gameStatus==='crashed'||gameState.gameStatus==='won'?/*#__PURE__*/_jsx(\"button\",{onClick:resetGame,className:\"btn-primary btn-bet\",children:\"New Game\"}):/*#__PURE__*/_jsx(\"button\",{onClick:startNewGame,disabled:!canBet,className:\"btn-primary btn-bet\",children:gameState.gameStatus==='waiting'?\"Bet $\".concat(formatMoney(gameState.betAmount)):'Place Bet'}),/*#__PURE__*/_jsxs(\"button\",{onClick:cashOut,disabled:!canCashOut,className:\"btn-primary btn-cashout\",children:[\"Cash Out $\",formatMoney(multiplyMoney(gameState.betAmount,gameState.currentMultiplier))]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"game-info\",children:/*#__PURE__*/_jsx(\"p\",{style:_objectSpread(_objectSpread({},applyTypography(typography.body.sm)),{},{color:textColors.secondary}),children:\"\\uD83D\\uDCA5 Watch the multiplier rise and cash out before it crashes! The longer you wait, the higher the potential payout.\"})})]})});};export default CrashGame;","map":null,"metadata":{},"sourceType":"module"}