{"ast":null,"code":"// VisualElements.tsx - React component for rendering question visuals\nimport React from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export const VisualElementRenderer=_ref=>{let{visual,className=\"\"}=_ref;// Helper: Try to parse a line graph from description\nconst tryRenderLineGraphFromDescription=desc=>{// Example desc: 'A line graph on an xy-plane with a grid. The x-axis ranges from -2 to 10. The y-axis ranges from -2 to 10. There are two lines graphed. The first line passes through the points (0, 8) and (8, 0). The second line passes through the points (0, 4) and (8, 0).'\nconst xRangeMatch=desc.match(/x-axis ranges from ([\\-\\d\\.]+) to ([\\-\\d\\.]+)/i);const yRangeMatch=desc.match(/y-axis ranges from ([\\-\\d\\.]+) to ([\\-\\d\\.]+)/i);const lineMatches=Array.from(desc.matchAll(/line passes through the points? \\(([^)]+)\\) and \\(([^)]+)\\)/gi));if(!xRangeMatch||!yRangeMatch||lineMatches.length===0)return null;const xMin=parseFloat(xRangeMatch[1]);const xMax=parseFloat(xRangeMatch[2]);const yMin=parseFloat(yRangeMatch[1]);const yMax=parseFloat(yRangeMatch[2]);const width=220,height=220,pad=32;// Map (x, y) to SVG coords\nconst map=(x,y)=>[pad+(x-xMin)/(xMax-xMin)*(width-2*pad),height-(pad+(y-yMin)/(yMax-yMin)*(height-2*pad))];// Parse lines\nconst lines=lineMatches.map(match=>{const[x1,y1]=match[1].split(',').map(Number);const[x2,y2]=match[2].split(',').map(Number);return{x1,y1,x2,y2};});// SVG\nreturn/*#__PURE__*/_jsxs(\"svg\",{width:width,height:height,style:{background:'#f8fafc',border:'1px solid #e5e7eb',borderRadius:8},children:[[...Array(11)].map((_,i)=>/*#__PURE__*/_jsx(\"line\",{x1:pad,x2:width-pad,y1:pad+i*(height-2*pad)/10,y2:pad+i*(height-2*pad)/10,stroke:\"#e0e7ef\",strokeWidth:1},i)),[...Array(11)].map((_,i)=>/*#__PURE__*/_jsx(\"line\",{y1:pad,y2:height-pad,x1:pad+i*(width-2*pad)/10,x2:pad+i*(width-2*pad)/10,stroke:\"#e0e7ef\",strokeWidth:1},i)),/*#__PURE__*/_jsx(\"line\",{x1:pad,x2:width-pad,y1:height-pad,y2:height-pad,stroke:\"#222\",strokeWidth:2}),/*#__PURE__*/_jsx(\"line\",{x1:pad,x2:pad,y1:pad,y2:height-pad,stroke:\"#222\",strokeWidth:2}),lines.map((line,i)=>{const[x1,y1]=map(line.x1,line.y1);const[x2,y2]=map(line.x2,line.y2);const color=i===0?'#2563eb':'#f59e42';return/*#__PURE__*/_jsx(\"line\",{x1:x1,y1:y1,x2:x2,y2:y2,stroke:color,strokeWidth:3},i);}),/*#__PURE__*/_jsx(\"text\",{x:width/2,y:height-4,textAnchor:\"middle\",fontSize:\"12\",fill:\"#222\",children:\"x\"}),/*#__PURE__*/_jsx(\"text\",{x:10,y:height/2,textAnchor:\"middle\",fontSize:\"12\",fill:\"#222\",transform:\"rotate(-90 10,\".concat(height/2,\")\"),children:\"y\"})]});};// Helper: Render structured graph data\nconst renderStructuredGraph=data=>{const{xRange,yRange,lines}=data;const[xMin,xMax]=xRange;const[yMin,yMax]=yRange;const width=300,height=300,pad=40;// Map (x, y) to SVG coords\nconst map=(x,y)=>[pad+(x-xMin)/(xMax-xMin)*(width-2*pad),height-(pad+(y-yMin)/(yMax-yMin)*(height-2*pad))];return/*#__PURE__*/_jsxs(\"svg\",{width:width,height:height,style:{background:'#f8fafc',border:'1px solid #e5e7eb',borderRadius:8},children:[[...Array(11)].map((_,i)=>/*#__PURE__*/_jsx(\"line\",{x1:pad,x2:width-pad,y1:pad+i*(height-2*pad)/10,y2:pad+i*(height-2*pad)/10,stroke:\"#e0e7ef\",strokeWidth:1},\"h\".concat(i))),[...Array(11)].map((_,i)=>/*#__PURE__*/_jsx(\"line\",{y1:pad,y2:height-pad,x1:pad+i*(width-2*pad)/10,x2:pad+i*(width-2*pad)/10,stroke:\"#e0e7ef\",strokeWidth:1},\"v\".concat(i))),/*#__PURE__*/_jsx(\"line\",{x1:pad,x2:width-pad,y1:height-pad,y2:height-pad,stroke:\"#222\",strokeWidth:2}),/*#__PURE__*/_jsx(\"line\",{x1:pad,x2:pad,y1:pad,y2:height-pad,stroke:\"#222\",strokeWidth:2}),lines.map((line,i)=>{const[x1,y1]=map(line.points[0][0],line.points[0][1]);const[x2,y2]=map(line.points[1][0],line.points[1][1]);return/*#__PURE__*/_jsx(\"line\",{x1:x1,y1:y1,x2:x2,y2:y2,stroke:line.color,strokeWidth:3},i);}),/*#__PURE__*/_jsx(\"text\",{x:width/2,y:height-4,textAnchor:\"middle\",fontSize:\"12\",fill:\"#222\",children:\"x\"}),/*#__PURE__*/_jsx(\"text\",{x:10,y:height/2,textAnchor:\"middle\",fontSize:\"12\",fill:\"#222\",transform:\"rotate(-90 10,\".concat(height/2,\")\"),children:\"y\"}),/*#__PURE__*/_jsx(\"text\",{x:pad,y:height-pad+15,textAnchor:\"middle\",fontSize:\"10\",fill:\"#666\",children:xMin}),/*#__PURE__*/_jsx(\"text\",{x:width-pad,y:height-pad+15,textAnchor:\"middle\",fontSize:\"10\",fill:\"#666\",children:xMax}),/*#__PURE__*/_jsx(\"text\",{x:pad-15,y:height-pad,textAnchor:\"middle\",fontSize:\"10\",fill:\"#666\",children:yMin}),/*#__PURE__*/_jsx(\"text\",{x:pad-15,y:pad,textAnchor:\"middle\",fontSize:\"10\",fill:\"#666\",children:yMax})]});};// Helper: Render structured table data\nconst renderStructuredTable=data=>{const{headers,rows}=data;return/*#__PURE__*/_jsx(\"div\",{className:\"visual-table \".concat(className),children:/*#__PURE__*/_jsxs(\"table\",{className:\"border-collapse border border-gray-300 mx-auto\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsx(\"tr\",{children:headers.map((header,i)=>/*#__PURE__*/_jsx(\"th\",{className:\"border border-gray-300 px-4 py-2 bg-gray-100 font-semibold\",children:header},i))})}),/*#__PURE__*/_jsx(\"tbody\",{children:rows.map((row,i)=>/*#__PURE__*/_jsx(\"tr\",{children:row.map((cell,j)=>/*#__PURE__*/_jsx(\"td\",{className:\"border border-gray-300 px-4 py-2 text-center\",children:cell},j))},i))})]})});};// Helper: Render multiple choice tables\nconst renderMultipleChoiceTables=tables=>{return/*#__PURE__*/_jsx(\"div\",{className:\"visual-multiple-tables \".concat(className),children:/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 gap-4\",children:tables.map((table,i)=>/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold mb-2\",children:table.label}),/*#__PURE__*/_jsxs(\"table\",{className:\"border-collapse border border-gray-300 mx-auto\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsx(\"tr\",{children:table.headers.map((header,j)=>/*#__PURE__*/_jsx(\"th\",{className:\"border border-gray-300 px-3 py-1 bg-gray-100 text-sm font-semibold\",children:header},j))})}),/*#__PURE__*/_jsx(\"tbody\",{children:table.rows.map((row,j)=>/*#__PURE__*/_jsx(\"tr\",{children:row.map((cell,k)=>/*#__PURE__*/_jsx(\"td\",{className:\"border border-gray-300 px-3 py-1 text-center text-sm\",children:cell},k))},j))})]})]},i))})});};const renderVisual=()=>{var _visual$data;switch(visual.type){case'graph':case'chart':case'diagram':if(visual.svg){return/*#__PURE__*/_jsx(\"div\",{className:\"visual-svg \".concat(className),dangerouslySetInnerHTML:{__html:visual.svg}});}// Check if we have structured graph data\nif(visual.data&&visual.data.xRange&&visual.data.yRange&&visual.data.lines){return renderStructuredGraph(visual.data);}// Try to auto-generate SVG from description\nconst autoSVG=tryRenderLineGraphFromDescription(visual.description);if(autoSVG)return autoSVG;return/*#__PURE__*/_jsx(\"div\",{className:\"visual-placeholder \".concat(className),children:/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:visual.description})});case'table':// Check if we have structured table data\nif(visual.data){if(visual.data.multipleChoice&&visual.data.tables){return renderMultipleChoiceTables(visual.data.tables);}if(visual.data.headers&&visual.data.rows){return renderStructuredTable(visual.data);}}// Legacy table rendering\nif((_visual$data=visual.data)!==null&&_visual$data!==void 0&&_visual$data.table){return/*#__PURE__*/_jsx(\"div\",{className:\"visual-table \".concat(className),children:/*#__PURE__*/_jsxs(\"table\",{className:\"border-collapse border border-gray-300\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsx(\"tr\",{children:visual.data.table.headers.map((header,i)=>/*#__PURE__*/_jsx(\"th\",{className:\"border border-gray-300 px-4 py-2 bg-gray-100\",children:header},i))})}),/*#__PURE__*/_jsx(\"tbody\",{children:visual.data.table.rows.map((row,i)=>/*#__PURE__*/_jsx(\"tr\",{children:row.map((cell,j)=>/*#__PURE__*/_jsx(\"td\",{className:\"border border-gray-300 px-4 py-2 text-center\",children:cell},j))},i))})]})});}// Try to parse a table from the description\nconst tableFromDesc=(()=>{// Example: 'A table with two columns, x and y. The rows contain the following pairs of values: (18, 130), (23, 160), (26, 178).'\nconst colMatch=visual.description.match(/table with (\\w+) columns?,? ([^\\.]+)\\./i);let headers=[];if(colMatch){headers=colMatch[2].split(/,| and /).map(h=>h.trim());}const rowMatch=visual.description.match(/rows contain the following pairs of values: ([^\\.]+)\\./i);let rows=[];if(rowMatch){rows=rowMatch[1].split(/\\),/).map(pair=>{const clean=pair.replace(/[()]/g,'').replace(/\\.$/,'').trim();return clean.split(',').map(v=>v.trim());});}if(headers.length&&rows.length){return/*#__PURE__*/_jsx(\"div\",{className:\"visual-table \".concat(className),children:/*#__PURE__*/_jsxs(\"table\",{className:\"border-collapse border border-gray-300\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsx(\"tr\",{children:headers.map((header,i)=>/*#__PURE__*/_jsx(\"th\",{className:\"border border-gray-300 px-4 py-2 bg-gray-100\",children:header},i))})}),/*#__PURE__*/_jsx(\"tbody\",{children:rows.map((row,i)=>/*#__PURE__*/_jsx(\"tr\",{children:row.map((cell,j)=>/*#__PURE__*/_jsx(\"td\",{className:\"border border-gray-300 px-4 py-2 text-center\",children:cell},j))},i))})]})});}return null;})();if(tableFromDesc)return tableFromDesc;break;case'equation':return/*#__PURE__*/_jsx(\"div\",{className:\"visual-equation \".concat(className),children:/*#__PURE__*/_jsx(\"div\",{className:\"math-display text-lg font-mono\",children:visual.description})});default:return/*#__PURE__*/_jsx(\"div\",{className:\"visual-description \".concat(className),children:/*#__PURE__*/_jsx(\"p\",{className:\"text-sm italic text-gray-600\",children:visual.description})});}};return/*#__PURE__*/_jsx(\"div\",{className:\"visual-element-container my-4\",children:renderVisual()});};export default VisualElementRenderer;","map":null,"metadata":{},"sourceType":"module"}